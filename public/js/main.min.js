$(function(){function o(){$("#js-jewmapHamburger").removeClass("active"),$("#js-classifier").removeClass("open"),$(window).width()<=600&&($(".leaflet-control-container").removeClass("hide"),$("#js-lang").removeClass("hide"))}$(window).on("resize",function(){o()}),$("#js-navListWrapper ul>li>a").on("click",function(){o()}),$('#js-classifier button[type="submit"]').click(function(e){e.preventDefault()}),$('#js-classifier input[type="text"]').on("change keydown keyup",function(){var a=$(this).val().toUpperCase(),o=a.length;$("#js-classifier ul").find("a").each(function(){var e=$(this).closest("li"),t=$(this).text().toUpperCase();(t=t.substring(0,o))!==a?e.hide():e.show()})});window.classifier={addClassifier:function(e,t){!function(t,e){sortedArray=function(t){t.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),t.forEach(function(e){if("Санкт-Петербург"===e.name)return t.splice(t.indexOf(e),1),t.unshift(e),!1}),t.forEach(function(e){if("Москва"===e.name)return t.splice(t.indexOf(e),1),t.unshift(e),!1});for(var e=Math.ceil(t.length/2),a=t.splice(0,e),o=[],i=0;i<e;i++)void 0!==a[i]&&o.push(a[i]),void 0!==t[i]&&o.push(t[i]);return t=o}(e);var a;a=sortedArray,Array.prototype.forEach.call(a,function(e){var t=document.createDocumentFragment(),a=document.querySelector("#js-templateClassifierItem").content.querySelector(".classifier__list-item").cloneNode(!0);a.querySelector(".classifier__list-link").setAttribute("data-id",e.id),a.querySelector(".classifier__list-link").textContent=e.name,a.querySelector(".classifier__list-link").setAttribute("data-status",e.status),a.querySelector(".classifier__list-link").setAttribute("data-point",e.point),t.appendChild(a),document.querySelector(".classifier__list").append(t)}),$("#js-classifierScrollbar").scrollBox(),$(".classifier__list-link").on("click",function(){var e=$(this).attr("data-point").split(",");window.util.flyTo(t,[parseFloat(e[0]),parseFloat(e[1])]),o()}),$(".jewmap__hamburger").on("click",function(){$("#js-jewmapHamburger").toggleClass("active"),$("#js-classifier").toggleClass("open"),$(window).width()<=600&&($(".leaflet-control-container").toggleClass("hide"),$("#js-lang").toggleClass("hide")),$(".popup").hasClass("open")&&($(".popup").removeClass("open"),$("#js-navListWrapper ul>li>a").removeClass("active"))})}(e,t)}}}),$(function(){function a(c,l){function i(){null===localStorage.getItem("districts")?$.ajax({method:"GET",url:"post.php",data:{request:2}}).done(function(e){var t=jQuery.parseJSON(e);localStorage.setItem("districts",JSON.stringify(t)),a(JSON.parse(localStorage.getItem("districts")))}):a(JSON.parse(localStorage.getItem("districts")))}function n(a,o){$.ajax({method:"GET",url:"post.php",data:{request:3,district:a}}).done(function(e){var t=jQuery.parseJSON(e),i=[];Array.prototype.forEach.call(t,function(a,e){if(0===i.length)i.push({term_city_id:a.term_city_id,name_city:a.name_city,latitude_city:a.latitude_city,longitude_city:a.longitude_city,orgs:[]}),i[0].orgs.push(a);else{var o=!1;Array.prototype.forEach.call(i,function(e,t){e.term_city_id===a.term_city_id&&(o=!0,e.orgs.push(a))}),!1===o&&i.push({term_city_id:a.term_city_id,name_city:a.name_city,latitude_city:a.latitude_city,longitude_city:a.longitude_city,orgs:[]})}}),s(i,o,a)})}function d(e,t,a,o){$("#js-geo .popup__main").html("");var s="";s+='<span class="geo__district-title"><span class="geo__district-text">'+a+'</span><span class="geo__district-item-descr">федеральный округ</span></span><span id="'+o+'" class="geo__city-title">'+t+"</span>",0!==e.length?(s+='<div class="geo__orgs-wrapper">',s+='<div class="geo__orgs">',Array.prototype.forEach.call(e,function(e,t){s+='<p class="geo__orgs-type"><span id="'+e.id_type+'">'+e.name_type+"</span></p>",Array.prototype.forEach.call(e.childs,function(e,t){if(s+='<div class="geo__org">',""!==e.lat||""!==e.lng?s+='<a href="#" data-lat="'+e.lat+'" data-lng="'+e.lng+'" data-address="'+e.address+'" data-phone="'+e.phone+'" data-email="'+e.email+'" data-site="'+e.site+'" class="geo__org-name">'+e.name+"</a>":s+='<p class="geo__org-name">'+e.name+"</p>",""!==e.rabbi&&null!==e.rabbi&&(s+='<p class="geo__org-rabbi"><span class="geo__org-icon icon-user"></span><span class="geo__org-text">'+e.rabbi+"</span></p>"),""!==e.address)if(""!==e.lat||""!==e.lng){var a="https://yandex.by/maps/?ll="+e.lng+","+e.lat+"&z=16&text="+e.name.split(" ").join("%20");s+='<a href="'+a+'" class="geo__org-address"><span class="geo__org-icon icon-address"></span><span class="geo__org-text">'+e.address+"</span></a>"}else s+='<p class="geo__org-address"><span class="geo__org-icon icon-address"></span><span class="geo__org-text">'+e.address+"</span></p>";if(""!==e.phone){var o=e.phone.split(";");if(0!==o.length){var i=function(e){var a=[];return Array.prototype.forEach.call(e,function(e){var t=e.split(" ").join("").split("(").join("").split(")").join("").split("-").join("").split("?").join("");a.push({phone:e,phoneLink:t})}),a}(o);s+='<div class="geo__org-phone"><span class="geo__org-icon icon-phone"></span><div class="geo__org-phone-content">',Array.prototype.forEach.call(i,function(e,t){s+='<a href="tel:'+e.phoneLink+'" class="geo__org-text">'+e.phone+"</a>"}),s+="</div></div>"}}s+="</div>"})}),s+="</div>",s+="</div>"):(s+='<div class="geo__orgs-wrapper">',s+='<div class="geo__orgs"><p>Ничего не найдено.</p>',s+="</div></div>"),$("#js-geo .popup__main").append(s),$(".popup").removeClass("open"),$("#js-geo").addClass("open"),$("#js-geo .geo__district-title").on("click",function(){i()}),$("#js-geo .geo__city-title").on("click",function(e){n(o,a)}),$("#js-geo a.geo__org-name").on("click",function(e){var t=parseFloat($(this).attr("data-lat")),a=parseFloat($(this).attr("data-lng")),o=$(this).text(),i=$(this).attr("data-address"),s=$(this).attr("data-phone"),n=$(this).attr("data-email"),r=$(this).attr("data-site");$(".popup").removeClass("open"),$("#js-jewmapHamburger").removeClass("move"),$("#js-jewmapSearch").removeClass("move"),$("#js-navListWrapper ul>li>a").removeClass("active"),window.util.flyTo(c,[t,a],13),window.util.addPopup(c,l,{name:o,point:[t,a],address:i,phone:s,email:n,site:r})})}var s=function(e,s,l){$("#js-geoCities .popup__main").html("");var a="",p=e.slice(0),t=function(e){e.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0});for(var t=Math.ceil(e.length/2),a=e.splice(0,t),o=[],i=0;i<t;i++)void 0!==a[i]&&o.push(a[i]),void 0!==e[i]&&o.push(e[i]);return o}(e);0!==e.length&&(a+='<span class="geo__district-title"><span class="geo__district-text">'+s+'</span><span class="geo__district-item-descr">федеральный округ</span></span>',a+='<ul class="geo__city-list">',Array.prototype.forEach.call(t,function(e,t){a+='<li class="geo__city-wrapper"><a id="'+e.term_city_id+'" class="geo__city-item" data-lat="'+e.latitude_city+'" data-lng="'+e.longitude_city+'">'+e.name_city+"</a></li>"}),a+="</ul>"),$("#js-geoCities .popup__main").append(a),$(".popup").removeClass("open"),$("#js-geoCities").addClass("open"),$("#js-geoCities .geo__district-title").on("click",function(){i()}),$("#js-geoCities .geo__city-item").on("click",function(e){var n=$(this).attr("id"),o=$(this).text(),t=parseFloat($(this).attr("data-lat")),a=parseFloat($(this).attr("data-lng")),r=[],i="";$.ajax({method:"GET",url:"post.php",data:{request:6,city:n}}).done(function(e){var t=jQuery.parseJSON(e);console.log("relig",t);var a=1;$.each(t,function(e,t){if(""!==t)return a=0}),0===a&&((i=t).lat="",i.lng="",i.site="")}),$.ajax({method:"GET",url:"post.php",data:{request:5}}).done(function(e){var t=jQuery.parseJSON(e);Array.prototype.forEach.call(t,function(a,e){var t={id_type:a.term_type_id,name_type:a.name_type,childs:[]},o="",i="";if(Array.prototype.forEach.call(p,function(e,t){if(e.term_city_id===n)return i=e,!1}),Array.prototype.forEach.call(i.orgs,function(e,t){e.ID===a.ID&&(o={id:e.ID,name:e.post_title,lat:e.latitude,lng:e.longitude,address:e.address,phone:e.phone,rabbi:e.rabbi,email:e.email,site:e.site})}),0===r.length)r.push(t),""!==o&&r[0].childs.push(o);else{var s=!1;Array.prototype.forEach.call(r,function(e,t){e.name_type===a.name_type&&(s=!0,""!==o&&e.childs.push(o))}),!1===s&&(r.push(t),""!==o&&r[r.length-1].childs.push(o))}});var a=[];""!==i&&Array.prototype.forEach.call(r,function(e,t){if("190"===e.id_type)return e.childs.unshift(i),!1}),Array.prototype.forEach.call(r,function(e,t){0!==e.childs.length&&("190"===e.id_type?(e.order=1,e.name_type="Религиозные организации"):"5"===e.id_type?e.order=2:"6"===e.id_type?e.order=3:"8"===e.id_type?e.order=4:"9"===e.id_type?e.order=5:"10"===e.id_type?e.order=6:"13"===e.id_type?e.order=7:"14"===e.id_type?e.order=8:"15"===e.id_type?e.order=9:"17"===e.id_type?e.order=10:"18"===e.id_type?e.order=11:"189"===e.id_type?e.order=12:e.order=13,a.push(e))}),a.sort(function(e,t){return e.order<t.order?-1:e.order>t.order?1:0}),d(a,o,s,l)}),window.util.flyTo(c,[t,a],13)})},a=function(e){$("#js-geoDistricts .popup__main").html("");var a="";0!==e.length&&(a+='<ul class="geo__district-list">',Array.prototype.forEach.call(e,function(e,t){a+='<li class="geo__district-wrapper"><a id="'+e.term_district_id+'" class="geo__district-item">'+e.name_district+'</a><span class="geo__district-item-descr">федеральный округ</span></li>'}),a+="</ul>"),$("#js-geoDistricts .popup__main").append(a),$("#js-jewmapHamburger").addClass("move"),$("#js-jewmapSearch").addClass("move"),$(".popup").removeClass("open"),$("#js-geoDistricts").addClass("open"),$("#js-geoDistricts .geo__district-item").on("click",function(e){var t=$(this).attr("id"),a=$(this).text();n(t,a);var o="",i="";switch(t){case"31":o=f,i=5;break;case"32":o=h,i=4;break;case"33":o=_,i=4.5;break;case"34":o=u,i=4;break;case"35":o=p,i=5;break;case"36":o=g,i=5.5;break;case"37":o=m,i=5.5;break;case"38":o=r,i=4}window.util.flyTo(c,o,i)})};$('#js-nav a[data-popup="geoDistricts"]').on("click",function(){i()})}var r=[64.825365,144.878838],p=[56.189357,51.733371],u=[70.600608,44.406038],m=[43.76515,44.735885],h=[70.886952,94.748395],_=[64.871851,71.569335],f=[54.905772,39.195997],g=[47.401426,41.055524];window.geo={addGeo:function(e,t){a(e,t)}}}),$(function(){$("#js-lang a").on("click",function(){$(this).removeClass("active");var e=$(this);$("#js-lang a").each(function(){$(e).text()!==$(this).text()&&$(this).addClass("active")})})}),$(function(){var n=[],e=new L.LatLngBounds([60,21],[69,167]);$(window).width()<=600&&(e=new L.LatLngBounds([40,25],[55,180])),L.mapbox.accessToken="pk.eyJ1IjoiYWxpYXBrbyIsImEiOiJjangyenVmeGMwcTFjM3lvNGhsdmUzejRoIn0.zdJYMN5sxS2SJXZV2Lb3aA";var d=L.map("map",{doubleClickZoom:!1,zoomControl:!0,zoomDelta:.25,zoomSnap:0,minZoom:2}).setView([63.674041,99.742382],4).addLayer(L.mapbox.styleLayer("mapbox://styles/aliapko/ck0066wpr2azz1cpl59flq3df"));d.fitBounds(e,{padding:[20,20]});var t=L.latLng(-89.98155760646617,-180),a=L.latLng(89.99346179538875,230),o=L.latLngBounds(t,a);d.setMaxBounds(o),d.on("drag",function(){d.panInsideBounds(o,{animate:!1})});var u=new L.popup({closeButton:!0,closeOnClick:!0,keepInView:!0});window.geo.addGeo(d,u),$.ajax({method:"GET",url:"post.php",data:{request:1}}).done(function(e){var t=jQuery.parseJSON(e);console.log(t),i(t),console.log(n),s(n);var a=n.slice(0);window.classifier.addClassifier(d,a)});var i=function(e){Array.prototype.forEach.call(e,function(o,e){var t={id:e,name:o.name_city,point:[""===o.latitude_city||null===o.latitude_city?"":parseFloat(o.latitude_city),""===o.longitude_city||null===o.longitude_city?"":parseFloat(o.longitude_city)],status:o.status_city,childs:[]},i={name:o.post_title,address:o.address,point:[""===o.latitude||null===o.latitude?"":parseFloat(o.latitude),""===o.longitude||null===o.longitude?"":parseFloat(o.longitude)],phone:o.phone,email:o.email,site:o.site};if(0===n.length)n.push(t),n[0].childs.push({coords:i.point,childsItems:[]}),n[0].childs[0].childsItems.push(i);else{var s=!1;Array.prototype.forEach.call(n,function(e,t){if(e.name===o.name_city){var a=!(s=!0);Array.prototype.forEach.call(e.childs,function(e,t){e.coords[0]===i.point[0]&&e.coords[1]===i.point[1]&&(a=!0,e.childsItems.push(i))}),!1===a&&(e.childs.push({coords:i.point,childsItems:[]}),e.childs[e.childs.length-1].childsItems.push(i))}}),!1===s&&(n.push(t),n[n.length-1].childs.push({coords:i.point,childsItems:[]}),n[n.length-1].childs[0].childsItems.push(i))}})},s=function(e){var a=L.mapbox.featureLayer(),o=L.mapbox.featureLayer(),i=L.mapbox.featureLayer(),s=L.mapbox.featureLayer(),n=L.mapbox.featureLayer();function r(e){var t=e.target._latlng;window.util.flyTo(d,[t.lat,t.lng])}function l(t){t.target._icon.classList.add("icon-hidden");var e=t.target._latlng,a=t.target.options.name,o=t.target.options.address,i=t.target.options.phone,s=t.target.options.email,n=t.target.options.site;window.util.flyTo(d,[e.lat,e.lng]),window.util.addPopup(d,u,{name:a,point:[parseFloat(e.lat),parseFloat(e.lng)],address:o,phone:i,email:s,site:n}),d.on("popupclose",function(e){null!==t.target._icon&&t.target._icon.classList.remove("icon-hidden")})}Array.prototype.forEach.call(e,function(e){if(""!==e.point[0]||""!==e.point[1])if("1"===e.status)if("Москва"===e.name){var t='<div class="jewmap__pin"><div class="jewmap__pin-icon"></div><span class="jewmap__pin-label">'+e.name+"</span></div>";L.marker(e.point,{icon:L.divIcon({html:t,className:"capital"}),zIndexOffset:40}).addTo(a).on("click",r)}else{t='<div class="jewmap__pin"><div class="jewmap__pin-icon"></div><span class="jewmap__pin-label">'+e.name+"</span></div>";L.marker(e.point,{icon:L.divIcon({html:t,className:"district"}),zIndexOffset:30}).addTo(o).on("click",r)}else if("2"===e.status){t='<div class="jewmap__pin"><div class="jewmap__pin-icon"></div><span class="jewmap__pin-label">'+e.name+"</span></div>";L.marker(e.point,{icon:L.divIcon({html:t,className:"region"}),zIndexOffset:20}).addTo(i).on("click",r)}else if("3"===e.status||null===e.status){t='<div class="jewmap__pin"><div class="jewmap__pin-icon"></div><span class="jewmap__pin-label">'+e.name+"</span></div>";L.marker(e.point,{icon:L.divIcon({html:t,className:"city"}),zIndexOffset:10}).addTo(s).on("click",r)}else{t='<div class="jewmap__pin"><div class="jewmap__pin-icon"></div><span class="jewmap__pin-label">'+e.name+"</span></div>";L.marker(e.point,{icon:L.divIcon({html:t,className:"city"}),zIndexOffset:10}).addTo(s).on("click",r)}Array.prototype.forEach.call(e.childs,function(e){if(1<e.childsItems.length){L.marker(e.coords,{icon:L.divIcon({html:'<div class="jewmap__pin_orgs"><div class="jewmap__pin-icon"></div><div class="jewmap__pin-quantity"><strong>'+e.childsItems.length+"<strong></div></div>",className:"orgs"}),zIndexOffset:50}).addTo(n).on("click",function(){!function(e){window.util.flyTo(d,e[0].point),window.util.addPopup(d,u,e,1)}(e.childsItems)})}else{var t=e.childsItems[0];if(""!==t.point[0]||""!==t.point[1])L.marker(t.point,{icon:L.icon({iconUrl:"public/img/building-blue.png",iconSize:[25,25],iconAnchor:[12,25],popupAnchor:[25,25]}),id:t.id,name:t.name,address:t.address,phone:t.phone,email:t.email,site:t.site}).addTo(n).on("click",l)}})}),d.addLayer(o),d.addLayer(a);function t(e){$(e+" .jewmap__pin-label").css("opacity","1"),$(e+" .jewmap__pin-label").css("pointer-events","auto")}function p(e){$(e+" .jewmap__pin-label").css("opacity","0"),$(e+" .jewmap__pin-label").css("pointer-events","none")}function c(e){$(window).width()<575?2<e&&e<3?(d.addLayer(i),p(".region"),d.removeLayer(s),d.closePopup(),d.removeLayer(n)):3<=e&&e<4?(d.addLayer(i),t(".region"),d.removeLayer(s),d.closePopup(),d.removeLayer(n)):4<=e&&e<5?(d.addLayer(i),t(".region"),d.addLayer(s),p(".city"),d.closePopup(),d.removeLayer(n)):5<=e&&e<13?(d.addLayer(a),d.addLayer(o),d.addLayer(i),t(".region"),d.addLayer(s),t(".city"),d.closePopup(),d.removeLayer(n)):e<=2?(d.addLayer(a),d.addLayer(o),d.removeLayer(i),d.removeLayer(s),d.closePopup(),d.removeLayer(n)):13<=e&&(d.addLayer(n),d.removeLayer(a),d.removeLayer(o),d.removeLayer(i),d.removeLayer(s)):4<e&&e<5?(d.addLayer(i),p(".region"),d.removeLayer(s),d.closePopup(),d.removeLayer(n)):5<=e&&e<6?(d.addLayer(i),t(".region"),d.removeLayer(s),d.closePopup(),d.removeLayer(n)):6<=e&&e<7?(d.addLayer(i),t(".region"),d.addLayer(s),p(".city"),d.closePopup(),d.removeLayer(n)):7<=e&&e<13?(d.addLayer(a),d.addLayer(o),d.addLayer(i),t(".region"),d.addLayer(s),t(".city"),d.closePopup(),d.removeLayer(n)):e<=4?(d.addLayer(a),d.addLayer(o),d.removeLayer(i),d.removeLayer(s),d.closePopup(),d.removeLayer(n)):13<=e&&(d.addLayer(n),d.removeLayer(a),d.removeLayer(o),d.removeLayer(i),d.removeLayer(s))}c(4),d.on("zoomend",function(e){var t=e.target._zoom;c(t)})}}),$(function(){function t(){$("#js-navHamburger").removeClass("active"),$("#js-navListWrapper").slideUp()}$("#js-navListWrapper ul>li>a").on("click",function(){$("#js-navListWrapper ul>li>a").removeClass("active"),$(this).addClass("active"),$(window).width()<=600&&t()}),$("#js-navHamburger").on("click",function(){$("#js-navHamburger").toggleClass("active"),$("#js-navListWrapper").slideToggle()}),$(document).click(function(e){if($(window).width()<=600){if($(e.target).closest("#js-navListWrapper").length)return;if($(e.target).closest("#js-navHamburger").length)return;t(),event.stopPropagation()}}),$(window).on("resize",function(){600<$(window).width()?($("#js-navListWrapper").show(),$("#js-navHamburger").removeClass("active")):t()})}),$(window).on("load",function(){$("#js-overlay").fadeIn(),$(window).width()<=600&&($(".leaflet-control-container").addClass("hide"),$("#js-infoButton").addClass("hide")),$("#js-overlay .overlay__close").on("click",function(){$("#js-overlay").fadeOut(),$(window).width()<=600&&($(".leaflet-control-container").removeClass("hide"),$("#js-infoButton").removeClass("hide"))}),$(document).click(function(e){$(e.target).closest("#js-overlay").length||($("#js-overlay").fadeOut(),event.stopPropagation(),$(window).width()<=600&&($(".leaflet-control-container").removeClass("hide"),$("#js-infoButton").removeClass("hide")))})}),$(function(){$(".popup__main").niceScroll({horizrailenabled:!1}),$("#js-navListWrapper ul>li>a").on("click",function(){var e=$(this).attr("data-popup");$("#js-"+e).hasClass("open")||($("#js-jewmapHamburger").addClass("move"),$("#js-jewmapSearch").addClass("move"),$(".popup").removeClass("open"),$("#js-"+e).addClass("open"))}),$(".popup__close").on("click",function(){$(".popup").removeClass("open"),$("#js-jewmapHamburger").removeClass("move"),$("#js-jewmapSearch").removeClass("move"),$("#js-navListWrapper ul>li>a").removeClass("active")})}),function(s,e,t){"use strict";var n="scrollBox",a={containerClass:"sb-container",containerNoScrollClass:"sb-container-noscroll",contentClass:"sb-content",scrollbarContainerClass:"sb-scrollbar-container",scrollBarClass:"sb-scrollbar"};function o(e,t){this.element=e,this.settings=s.extend({},a,t),this._defaults=a,this._name=n,this.init()}s.extend(o.prototype,{init:function(){this.addScrollbar(),this.addEvents(),this.onResize()},addScrollbar:function(){s(this.element).addClass(this.settings.containerClass),this.wrapper=s("<div class='"+this.settings.contentClass+"' />"),this.wrapper.append(s(this.element).contents()),s(this.element).append(this.wrapper),this.scollbarContainer=s("<div class='"+this.settings.scrollbarContainerClass+"' />"),this.scrollBar=s("<div class='"+this.settings.scrollBarClass+"' />"),this.scollbarContainer.append(this.scrollBar),s(this.element).prepend(this.scollbarContainer)},addEvents:function(){this.wrapper.on("scroll."+n,s.proxy(this.onScroll,this)),s(e).on("resize."+n,s.proxy(this.onResize,this)),this.scrollBar.on("mousedown."+n,s.proxy(this.onMousedown,this)),this.scrollBar.on("touchstart."+n,s.proxy(this.onTouchstart,this))},onTouchstart:function(a){var o=this;a.preventDefault();var i=o.scrollBar[0].offsetTop;s(t).on("touchmove."+n,function(e){var t=e.touches[0].pageY-a.touches[0].pageY;o.scrollBar[0].style.top=Math.min(o.scollbarContainer[0].clientHeight-o.scrollBar[0].clientHeight,Math.max(0,i+t))+"px",o.wrapper[0].scrollTop=o.wrapper[0].scrollHeight*o.scrollBar[0].offsetTop/o.scollbarContainer[0].clientHeight}),s(t).on("touchend."+n,function(){s(t).off("touchmove."+n),s(t).off("touchend."+n)})},onMousedown:function(a){var o=this;a.preventDefault();var i=o.scrollBar[0].offsetTop;s(t).on("mousemove."+n,function(e){var t=e.pageY-a.pageY;o.scrollBar[0].style.top=Math.min(o.scollbarContainer[0].clientHeight-o.scrollBar[0].clientHeight,Math.max(0,i+t))+"px",o.wrapper[0].scrollTop=o.wrapper[0].scrollHeight*o.scrollBar[0].offsetTop/o.scollbarContainer[0].clientHeight}),s(t).on("mouseup."+n,function(){s(t).off("mousemove."+n),s(t).off("mouseup."+n)})},onResize:function(){this.wrapper.css("max-height",s(this.element).height());var e=this.wrapper[0].clientHeight;this.scrollBar.css("height",this.scollbarContainer[0].clientHeight*e/this.wrapper[0].scrollHeight+"px"),this.scollbarContainer[0].clientHeight<=this.scrollBar[0].clientHeight?s(this.element).addClass(this.settings.containerNoScrollClass):s(this.element).removeClass(this.settings.containerNoScrollClass),this.onScroll()},onScroll:function(){this.scrollBar.css("top",Math.min(this.scollbarContainer[0].clientHeight-this.scrollBar[0].clientHeight,this.scollbarContainer[0].clientHeight*this.wrapper[0].scrollTop/this.wrapper[0].scrollHeight)+"px")}}),s.fn[n]=function(e){return this.each(function(){s.data(this,"plugin_"+n)||s.data(this,"plugin_"+n,new o(this,e))})}}(jQuery,window,document),$(function(){var r=function(e){var a=[];return Array.prototype.forEach.call(e,function(e){var t=e.split(" ").join("").split("(").join("").split(")").join("").split("-").join("").split("?").join("");a.push({phone:e,phoneLink:t})}),a};window.util={flyTo:function(e,t,a){!function(e,t,a){void 0===a&&(a=(a=e.getZoom())<=13?13:a),e.flyTo([t[0],t[1]],a,{duration:1.1,easeLinearity:.45})}(e,t,a)},addPopup:function(e,t,a,o){!function(e,t,a,o){$(".jewmap-popup").html(""),1!==o&&(o=0);var i="",s="";i=o?(s+='<div class="jewmap-popup jewmap-popup_list"><ul class="jewmap-popup__list">',Array.prototype.forEach.call(a,function(e,t){s+='<li class="jewmap-popup__list-item"><a id="'+t+'" class="jewmap-popup__list-link"><strong>'+e.name+"</strong></a></li>"}),s+="</ul>",a[0]):(s+='<div class="jewmap-popup jewmap-popup_no-list">',a),s+='<div class="jewmap-popup__content">';function n(e){var a="",t="https://yandex.by/maps/?ll="+e.point[1]+","+e.point[0]+"&z=16&text="+e.name.split(" ").join("%20");a+='<p class="jewmap-popup__name"><strong>'+e.name+"</strong></p>",""!==e.address&&(a+='<a href="'+t+'" class="jewmap-popup__text jewmap-popup__address">'+e.address+"</a>");var o=r(e.phone.split(";"));return 0!==o.length&&(a+='<div class="jewmap-popup__phone-wrapper">',Array.prototype.forEach.call(o,function(e,t){a+='<a href="tel:'+e.phoneLink+'" class="jewmap-popup__text jewmap-popup__phone">'+e.phone+"</a>",t<o.length-1&&(a+=", ")}),a+="</div>"),""!==e.email&&(a+='<a href="mailto:'+e.email+'" class="jewmap-popup__text jewmap-popup__email">'+e.email+"</a>"),""!==e.site&&(a+='<a href="'+e.site+'" class="jewmap-popup__text jewmap-popup__site">'+e.site+"</a>"),a}s+=n(i),s+="</div>",s+="</div>",t.setLatLng(i.point).setContent(s).openOn(e),$(".jewmap-popup__list").niceScroll(),e.on("popupclose",function(e){$(".jewmap-popup__list").getNiceScroll().remove()}),$(".jewmap-popup__list-link").on("click",function(e){var t=$(this).attr("id");$(".jewmap-popup__content").html(""),$(".jewmap-popup__content").append(n(a[t]))})}(e,t,a,o)},getPhonesWithLinks:function(e){r(e)}}});
//# sourceMappingURL=main.min.js.map
